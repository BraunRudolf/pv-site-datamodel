name: CI Pipeline for SDK - Python

on:
  push:
    branches: ["main"]

env:
  PYTHON_ROOT_DIRECTORY: sdk/python
  PYTHON_PACKAGE_NAME: pvsite_datamodel

jobs:
  test:
    uses: openclimatefix/.github/.github/workflows/python-test.yml@working-directory
    with:
      workdir: ${{ env.PYTHON_ROOT_DIRECTORY }}

  publish:
    needs: [test]
    uses: openclimatefix/.github/.github/workflows/python-release.yml@working-directory
    secrets:
      token: ${{ secrets.PYPI_API_TOKEN }}
    with:
      workdir: ${{ env.PYTHON_ROOT_DIRECTORY }}
